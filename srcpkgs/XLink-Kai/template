# Template file for 'XLink-Kai'
pkgname=XLink-Kai
version=7.4.45
revision=1
archs="i686 x86_64"
build_style=fetch
hostmakedepends="curl tar"
short_desc="VPN Tunnler to allow old consoles and games to play online"
maintainer="Sapein <5852983+Sapein@users.noreply.github.com>"
license="custom:Proprietary"
homepage="https://www.teamxlink.co.uk/"
_additional="651430714"
restricted=yes
repository=nonfree

pre_fetch() {
	case "${XBPS_TARGET_MACHINE}" in
		'x86_64')
			target="amd64"
			arch="x86_64"
			export checksum="dd7eae6f5b0e8f3482150560cbef057af891510a5c8777cd7cce710df84e5fe4"
			;;
		'i686')
			target="i386"
			arch="x86"
			export checksum="ae4882b1110f7d96ee951fc0e482b0f0fc71087200a3f291a11a24236008c05d"
			;;
	esac
	export distfiles="https://dist.teamxlink.co.uk/linux/debian/static/standalone/release/${target}/xlinkkai_${version}_${_additional}_standalone_${arch}.tar.gz"
}

do_fetch() {
	curl $distfiles -o xlinkkai.tar.gz
	curr_sum=$(cat xlinkkai.tar.gz | sha256sum | sed -e 's/-//')
	test $curr_sum == $checksum
}

do_extract() {
	mv ../xlinkkai.tar.gz ./
	tar xvf xlinkkai.tar.gz
}

do_install() {
	cd "kaiEngine-standalone"
	vbin kaiengine
	vsv xlink-kai
}

post_install() {
	echo "The current Terms and License can be found at: https://www.teamxlink.co.uk/disclaimer" > LICENSE
	vlicense LICENSE
}

